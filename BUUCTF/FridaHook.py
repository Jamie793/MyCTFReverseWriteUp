import sys
import frida


def on_message(message, data):
    if message['type'] == 'send':
        print("[*] {0}".format(message['payload']))
    else:
        print(message)


jscode = '''
Java.perform(()=>{
    var A = Java.use('com.tencent.O00OOOOO0000OO00000O0OOOO00O0OO00OO0OO0000OOO000O00OO000O00OO00OOOOOO00OOO000OO0O0OO00OOOOOOOOO00OO000OOOO00O0OOO0OO00O00O0O000000O0OO00O000O0O0O0OOO0000O0O00OOO0OO00O0OO0OO000000O00OOO0O00OOOOOO00O0O00OOO00O0OO0OO0OOO0O00OO0O00OO0000000O00OO0O0OOOO00000O0OOOO00O00O0OOO0O0O0O0OO00OOOO0O000O0O000000.O00OOOOO0000OO00000O0OOOO00O0OO00OO0OO0000OOO000O00OO000O00OO00OOOOOO00OOO000OO0O0OO00OOOOOOOOO00OO000OOOO00O0OOO0OO00O00O0O000000O0OO00O000O0O0O0OOO0000O0O00OOO0OO00O0OO0OO000000O00OOO0O00OOOOOO00O0O00OOO00O0OO0OO0OOO0O00OO0O00OO0000000O00OO0O0OOOO00000O0OOOO00O00O0OOO0O0O0O0OO00OOOO0O000O0O000000')
    var kkk = Java.use('com.tencent.mapsdk.O00O00OOO000O0000OOOOO0OO00OOOOO0OOOOO0O0OO0O0O0000000O00OOO0OOO000OO000O0O000OOOOOO0OO0O0OO00OO0000OO0O0OOO0OOOOOO0OO0O00O00O0000OOO00O0O00OOO0OOOO0O0O0O00O0O0O00OO0O0O0O0O0O00O00O00O0000OOOOOO0OOOO0O0OOO0OO00O0000000OOOO0O0O00O0OOO00OOO0OO000O000OOO0O0OOOO000OO0O0O00O00OOOOOOO0O000O0O0O000O000O00')
    var Log = Java.use("android.util.Log")
    var Exception = Java.use("java.lang.Exception")
    console.log('Test...')
    A.O00OOO00O0O000OO00O000OO0OO0000OO0O0OOOOO000O0000OO0O0O00O0O0O00OO0O0OOOO0O0OOOO0OOOO0O0O00OO000O0000OO000O0O00O0000O0OOOOO0O00O00OO0O0OOOOOOOO0OOO0O0000OO0O000O0OO0OO000000OO00O00OOO0000OOO0OOOO000000OOOOOOOO00OO00OOO0OO0O00OOO0O00OOO0OOO0OO0000O00O0O0O000O00O0O0000OOO0O0000O000O0O0OO0OOOO0000O0OO.overload('java.lang.String').implementation = function(p1){
        console.log(Log.getStackTraceString(Exception.$new()));
        //send(p1)
    }
})
'''

rdev = frida.get_remote_device()
pid = rdev.spawn('com.qqgame.hlddz')
session = rdev.attach(pid)
rdev.resume(pid)

script = session.create_script(jscode)
script.on('message', on_message)
script.load()
sys.stdin.read()
